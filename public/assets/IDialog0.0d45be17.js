var e=Object.defineProperty,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,r=(e,r)=>{for(var l in r||(r={}))i.call(r,l)&&o(e,l,r[l]);if(t)for(var l of t(r))s.call(r,l)&&o(e,l,r[l]);return e};"undefined"!=typeof require&&require;import{c as l,f as a,g as d,x as c,D as n,t as m,q as g,v as p,o as f,y,H as u}from"./index.154289d4.js";import{_ as h}from"./stage2.41e6de3a.js";var b=h({props:{item:Object,show:Boolean,tier:String,overrideTier:String,size:{type:String,default:"large"},scroll:{type:Boolean,default:!0},btnClose:Boolean,seamless:{type:Boolean,default:!0},position:String,itemless:Boolean,width:String,height:String,flex:String,cardStyle:Object,cardClasses:Object,cardBodyStyle:Object,emitCardReference:Boolean,useGrid:String,clickAttention:Boolean},setup(e,{slots:t,emit:i}){inject("app");return{slots:t,isVisible:l({get:()=>e.item?!e.item.dialog0||e.item.dialog0.show:e.show,set:t=>{e.item||t||i("close"),e.item&&e.item.dialog0?e.item.dialog0.show=t:ecs.app.app0.close(e.item.id)}}),closeClick:()=>{if(e.item&&e.item.attention0&&e.item.attention0.back(),e.item&&e.item.grid0user){const t=ecs.root[e.item.grid0user.gridID];e.item.dialog0&&(e.item.dialog0.show=!1),t.grid0.dismiss(e.item)}else e.item&&e.item.dialog0&&!e.emitShow?e.item.dialog0.show=!1:i("update:show",!1)},onEscape:()=>{},maybeEmitCardReference:t=>{console.log("maybe emit card reference",e.emitCardReference),e.emitCardReference&&(console.log("Emit card reference"),i("card0ref",t))},theCardStyle:l((()=>{if(e.item&&e.item.grid0user){const t=ecs.root[e.item.grid0user.gridID];if(!t)return void core.log(`[IDialog ${e.item.id}] Grid ${e.item.grid0user.gridID} not found.`);let i=t.grid0.roster[e.item.id];if(i?console.log("has record",i):(console.log("no record",e.item.grid0user.defaultRecord),t.grid0.roster[e.item.id]=e.item.grid0user.defaultRecord,i=t.grid0.roster[e.item.id]),"screen0"===t.grid0.scale){const s=t.space2.pixelSize(i.size),o=t.space2.pixelPosition(i.pos);return r(r(r({},e.cardStyle||{}),core.style.size(s)),core.style.transform(o))}{const s=t.space1.pixelSize(i.size),o=t.space1.pixelPosition(i.pos);return r(r(r({},e.cardStyle||{}),core.style.size(s)),core.style.transform(o))}}return console.log("not a grid user"),r({maxHeight:"calc(100vh - 40px)"},e.cardStyle||{})})),dialogClick:()=>{e.clickAttention&&(e.item.attention0||ecs.addComponent(e.item,ecs.compo.attention0()),e.item.attention0.gain())},classes:l((()=>e.item&&e.item.attention0&&!e.item.attention0.present?{passive:!0}:{}))}}},[["render",function(e,t,i,s,o,l){const h=a("ICard0");return s.isVisible?(f(),d("div",{key:0,class:m(["i-dialog-0",s.classes]),maximized:"",onKey:t[1]||(t[1]=(...e)=>s.onEscape&&s.onEscape(...e)),style:g(s.theCardStyle),onClick:t[2]||(t[2]=(...e)=>s.dialogClick&&s.dialogClick(...e))},[c(h,{item:i.item,headerClasses:"relative-position",flowClasses:{"full-height":!0},tier:i.tier,overrideTier:i.overrideTier,class:m(r({[i.size]:!i.item||!i.item.grid0user,"on-grid":i.item&&i.item.grid0user},i.cardClasses||{})),scroll:i.scroll,bodyClasses:{"overflow-hidden":!i.scroll},itemless:i.itemless,width:i.width,height:i.height,flex:i.flex,bodyStyle:i.cardBodyStyle,ref:e=>s.maybeEmitCardReference(e),style:g(i.cardStyle)},{header:n((()=>[y(e.$slots,"header",{},void 0,!0)])),headerButtons:n((()=>[y(e.$slots,"headerButtons",{},void 0,!0),i.btnClose?(f(),d("div",{key:0,class:"btn-close",onClick:t[0]||(t[0]=u(((...e)=>s.closeClick&&s.closeClick(...e)),["stop"]))})):p("",!0)])),default:n((()=>[y(e.$slots,"default",{},void 0,!0)])),left:n((()=>[y(e.$slots,"left",{},void 0,!0)])),_:3},8,["item","tier","overrideTier","class","scroll","bodyClasses","itemless","width","height","flex","bodyStyle","style"])],38)):p("",!0)}],["__scopeId","data-v-17854512"]]);export{b as default};
