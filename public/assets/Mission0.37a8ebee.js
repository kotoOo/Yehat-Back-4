var e=Object.defineProperty,i=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,a=(i,t,s)=>t in i?e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s,o=(e,o)=>{for(var n in o||(o={}))t.call(o,n)&&a(e,n,o[n]);if(i)for(var n of i(o))s.call(o,n)&&a(e,n,o[n]);return e};"undefined"!=typeof require&&require;import{f as n,B as r,l as c,D as l,g as d,j as m,y as p,x as u,E as v,z as f,A as y,o as g,C as k,J as w,G as b,k as x,F as h,v as S}from"./index.154289d4.js";import{_ as D}from"./stage2.41e6de3a.js";const N={props:{item:Object,view:{type:String,default:"base"}},setup(e){const i=reactive({config:computed((()=>{const e={useDateFormatMask:"MM-DD-YYYY"},i=ecs.findOne((e=>"Code1"===e.type&&"config00"===e.code1.name&"YykawqvDqjBOYcKCw4VmQS"===e.located.rel));if(i){const t=o(o({},e),i.code1.run());return core.log("[Mission0] using config",t),t}return core.log("[Mission0] using INITIAL config",e),e}))}),t=computed((()=>e.item.connections.project?pure.itemName(e.item.c.project):"Pick")),s=computed((()=>e.item.connections.project?e.item.c.project.tier?e.item.c.project.tier.base:"proto":"monkeys")),a=computed((()=>{const i=ecs.findOne((i=>"GTDStatus0"==i.type&&"ecKFQsOLw4rDiERkwrTCtB"==i.located.rel&&i.gtdStatus0.name===e.item.mission0.status));return i?i.i.caption:"Unknown"})),n=computed((()=>{const i=ecs.findOne((i=>"GTDStatus0"==i.type&&"ecKFQsOLw4rDiERkwrTCtB"==i.located.rel&&i.gtdStatus0.name===e.item.mission0.status));return i?i.tier.base:"proto"})),r={onhold:{available:{cmd:"run",caption:"Run",roles:["commander"]},cancelled:{cmd:"cancel",caption:"Cancel",roles:["commander"]}},available:{onhold:{cmd:"putOnHold",caption:"Put on Hold",roles:["commander"]},cancelled:{cmd:"cancel",caption:"Cancel",roles:["commander"]},inprogress:{cmd:"ready",caption:"Take",roles:["executive"]},active:{cmd:"start",caption:"Start Now",roles:["executive"]},blocked:{cmd:"block",caption:"Block",roles:["executive"]}},inprogress:{disrupted:{cmd:"disrupt",caption:"Disrupt",roles:["commander"]},active:{cmd:"start",caption:"Start Now",roles:["executive"]},blocked:{cmd:"block",caption:"Block",roles:["executive"]},done:{cmd:"done",caption:"Done!",roles:["executive"]},failed:{cmd:"fail",caption:"Failed!",roles:["executive"]}},active:{disrupted:{cmd:"disrupt",caption:"Disrupt",roles:["commander"]},inprogress:{cmd:"inprogress",caption:"Continue Later",roles:["executive"]},blocked:{cmd:"block",caption:"Block",roles:["executive"]},done:{cmd:"done",caption:"Done!",roles:["executive"]},failed:{cmd:"fail",caption:"Failed!",roles:["executive"]}},blocked:{disrupted:{cmd:"disrupt",caption:"Disrupt",roles:["commander"]},inprogress:{cmd:"inprogress",caption:"Continue Later",roles:["executive"]},active:{cmd:"start",caption:"Start Now",roles:["executive"]},done:{cmd:"done",caption:"Done!",roles:["executive"]},failed:{cmd:"fail",caption:"Failed!",roles:["executive"]}},done:{approved:{cmd:"approve",caption:"Approve",roles:["commander"]},notapproved:{cmd:"unapprove",caption:"Unapprove",roles:["commander"]},inprogress:{cmd:"inprogress",caption:"Not done yet",roles:["executive"]},active:{cmd:"start",caption:"Fix Now",roles:["executive"]}},notapproved:{approved:{cmd:"approve",caption:"Approve",roles:["commander"]},done:{cmd:"done",caption:"Revoke the review",roles:["commander"]},inprogress:{cmd:"inprogress",caption:"Rework Later",roles:["executive"]},active:{cmd:"start",caption:"Rework Now",roles:["executive"]}},approved:{done:{cmd:"done",caption:"Revoke the review",roles:["commander"]}},failed:{blocked:{cmd:"block",caption:"Make Hope",roles:["executive"]},inprogress:{cmd:"inprogress",caption:"Try Again",roles:["executive"]}}},c={onhold:"available",available:"inprogress",inprogress:"active",blocked:"active"},l=i=>{const t=e.item.mission0.status;r[t]&&r[t][i]?(core.log(`${pure.itemToken(e.item)} Transition valid. We are to: ${r[t][i].caption}`),e.item.mission0.status=i,e.item.saveLocal.save(),Quasar.Notify.create("Status updated.")):Quasar.Notify.create("No valid transition for the mission in this status."+t)},d=computed((()=>e.item.mission0.commander?pure.itemName(ecs.root[e.item.mission0.commander]):"None")),m=ecs.by((i=>~e.item.mission0.assigned.indexOf(i.id)),{map:e=>({id:e.id,name:pure.itemName(e),tier:e.tier?e.tier.base:"poormans"})}),p=computed((()=>{const i=e.item.mission0.priority;return{en:{1:"Postponed",2:"Very Low",3:"Low",4:"Normal",5:"Normal +",6:"High",7:"High +",8:"Very High",9:"Urgent",10:"ASAP"},ru:{1:"Отложено",2:"Очень низкий",3:"Низкий",4:"Обычный",5:"Обычный +",6:"Высокий",7:"Высокий +",8:"Очень Высокий",9:"Срочно",10:"Как Можно Скорее"}}[core.yehat.lang][i]||"?"})),u=ecs.by((i=>"Msg0"===i.type&&i.conn.rel===e.item.id)),v=ecs.by((i=>"Msg0"===i.type&&i.conn.rel===e.item.id));return{state:i,save:()=>{e.item.saveLocal.save(),Quasar.Notify.create("Saved Locally.")},hardDeadlineYes:()=>{e.item.mission0.hardDeadline=!0,Quasar.Notify.create("The mission will be automatically failed as the time runs out.")},hardDeadlineNo:()=>{e.item.mission0.hardDeadline=!1,Quasar.Notify.create("Failing a deadline will not automatically fail the mission.")},changeProject:i=>{e.item.connections.project=i,Quasar.Notify.create("Project connection updated [Volatile] => Save to Confirm!")},projectTitle:t,projectTier:s,missionStatus:a,missionStatusTier:n,setStatus:l,run:()=>{const i=e.item.mission0.status;c[i]?l(c[i]):Quasar.Notify.create("No valid transitions to run from the current mission status: "+i)},setStatusByID:i=>{const t=ecs.root[i].gtdStatus0.name,s=e.item.mission0.status;core.log(`${pure.itemToken(e.item)} <[setStatusByID] ${pure.itemToken(ecs.root[i])} ...`),r[s]&&r[s][t]?(core.log(`${pure.itemToken(e.item)} Transition valid. We are to: ${r[s][t].caption}`),e.item.mission0.status=t,e.item.saveLocal.save(),Quasar.Notify.create("Status updated.")):Quasar.Notify.create("No valid transition for the mission in this status."+s)},commanderTitle:d,setCommander:i=>{core.log(`${pure.itemToken(e.item)} setCommander`,i),e.item.mission0.commander=i,Quasar.Notify.create("Commander assigned.")},assignDev:i=>{~e.item.mission0.assigned.indexOf(i)?Quasar.Notify.create("Already assigned."):(e.item.mission0.assigned.push(i),Quasar.Notify.create("Assigned."))},devs:m,banish:i=>{const t=e.item.mission0.assigned.indexOf(i.id);e.item.mission0.assigned.splice(t,1),Quasar.Notify.create("Unassigned.")},priorityCaption:p,msgs:u,msgsUnread:v}}};f("data-v-0e3ba434");const j=b("Mission0"),C={class:"column full-height no-wrap"},P={class:"col scroll"},T={class:"c-item"},_=m("div",{class:"caption"},"Brief",-1),q={class:"value"},O={class:"c-item-line items-center"},B=m("div",{class:"caption"},"Status",-1),Q={class:"value"},F={class:"c-item"},L=m("div",{class:"caption"},"Summary",-1),M={class:"value"},R={class:"c-item"},V={class:"caption"},A={class:"value"},$={class:"c-item"},U=m("div",{class:"caption"},"Deadline",-1),E={class:"value"},I={class:"row items-center justify-end"},Y={class:"c-item-line"},H=m("div",{class:"caption"},"Hard Deadline",-1),G={class:"value"},K=b("YES"),z=b("NO"),W={class:"c-item"},J=m("div",{class:"caption"},"Tags",-1),X={class:"value"},Z={class:"c-item-line"},ee=m("div",{class:"caption"},"Project",-1),ie={class:"value"},te={class:"c-item-line"},se=m("div",{class:"caption"},"Dryware",-1),ae={class:"value"},oe=b("Select"),ne=b("New"),re={class:"c-item-line"},ce=m("div",{class:"caption"},"Commander",-1),le={class:"value"},de={key:1,class:"statement"},me={class:"c-item-line"},pe=m("div",{class:"caption"},"Assigned",-1),ue={class:"value column q-gutter-x-xs items-end justify-end"},ve=m("span",{style:{"margin-left":"-12px"}},"x",-1),fe={key:0,class:"statement"},ye=b("Add"),ge=m("div",{class:"row no-wrap compart",style:{"z-index":"1",position:"relative","padding-top":"6px","margin-bottom":"10px"}},[m("div",{class:"card-f-0"}),m("div",{class:"card-f-1"},"-[ Mission0.Sequence ]"),m("div",{class:"card-f-2"})],-1),ke=m("div",{class:"row no-wrap compart",style:{"margin-bottom":"4px"}},[m("div",{class:"card-f-0"}),m("div",{class:"card-f-1"}),m("div",{class:"card-f-2"})],-1),we={class:"c-item-line"},be=m("div",{class:"caption"},"Run After",-1),xe={class:"value"},he=b("Select"),Se={class:"c-item-line"},De=m("div",{class:"caption"},"Stack",-1),Ne={class:"value"},je=b("Not in Stack"),Ce=m("div",{class:"row no-wrap compart"},[m("div",{class:"card-f-0"}),m("div",{class:"card-f-1"}),m("div",{class:"card-f-2"})],-1),Pe={class:"col-auto row items-center justify-center q-gutter-x-xs widget-footer"},Te=b("Run"),_e=b("Save"),qe=b("Scrap"),Oe={key:1,class:"mission-0"},Be={class:"mission-0-badge row no-wrap"},Qe={class:"col-auto n q-px-xs"},Fe={class:"col-auto icon q-px-xs text-center"},Le={class:"col"},Me={class:"row no-wrap"},Re={class:"short col"},Ve={class:"status col-auto"},Ae={key:2,class:"mission-0"};y();var $e=D(N,[["render",function(e,i,t,s,a,o){const f=n("Fav0"),y=n("BtnResize0"),D=n("BtnMove0"),N=n("picker0"),$e=n("PriorityPicker0"),Ue=n("q-btn"),Ee=n("q-date"),Ie=n("q-popup-proxy"),Ye=n("q-icon"),He=n("q-input"),Ge=n("btn0"),Ke=n("Chat0"),ze=n("IDialog0"),We=n("Priority0"),Je=r("close-popup");return"base"===t.view?(g(),c(ze,{key:0,item:t.item,itemless:"","btn-close":"",class:"mission-0",scroll:!1,cardBodyStyle:{padding:0},"click-attention":""},{headerButtons:l((()=>[u(f,{item:t.item},null,8,["item"]),u(y,{item:t.item,dir:"w"},null,8,["item"]),u(y,{item:t.item,dir:"a"},null,8,["item"]),u(y,{item:t.item,dir:"s"},null,8,["item"]),u(y,{item:t.item,dir:"d"},null,8,["item"]),u(D,{item:t.item},null,8,["item"])])),header:l((()=>[j])),default:l((()=>[m("div",C,[m("div",P,[m("div",T,[_,m("div",q,[k(m("input",{"onUpdate:modelValue":i[0]||(i[0]=e=>t.item.mission0.short=e),class:"input"},null,512),[[w,t.item.mission0.short]])])]),m("div",O,[B,m("div",Q,[u(N,{query:"v.type == 'GTDStatus0' && v.located.rel == 'ecKFQsOLw4rDiERkwrTCtB'",nameEP:"i.caption",orderBy:"gtdStatus0.order",tier:s.missionStatusTier,onPick:s.setStatusByID},{default:l((()=>[b(v(s.missionStatus),1)])),_:1},8,["tier","onPick"])])]),m("div",F,[L,m("div",M,[k(m("textarea",{"onUpdate:modelValue":i[1]||(i[1]=e=>t.item.mission0.details=e),class:"editor"},null,512),[[w,t.item.mission0.details]])])]),m("div",R,[m("div",V,"Priority: "+v(s.priorityCaption),1),m("div",A,[u($e,{item:t.item},null,8,["item"])])]),m("div",$,[U,m("div",E,[u(He,{modelValue:t.item.mission0.deadline,"onUpdate:modelValue":i[3]||(i[3]=e=>t.item.mission0.deadline=e),class:"input",dense:"",outlined:""},{prepend:l((()=>[u(Ye,{name:"event",class:"cursor-pointer"},{default:l((()=>[u(Ie,{"transition-show":"scale","transition-hide":"scale"},{default:l((()=>[u(Ee,{modelValue:t.item.mission0.deadline,"onUpdate:modelValue":i[2]||(i[2]=e=>t.item.mission0.deadline=e),mask:s.state.config.useDateFormatMask},{default:l((()=>[m("div",I,[k(u(Ue,{label:"Close",color:"primary",flat:""},null,512),[[Je]])])])),_:1},8,["modelValue","mask"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])]),m("div",Y,[H,m("div",G,[u(Ge,{tier:t.item.mission0.hardDeadline?"monkeys":"proto",class:"q-mr-xs",onClick:i[4]||(i[4]=e=>s.hardDeadlineYes())},{default:l((()=>[K])),_:1},8,["tier"]),u(Ge,{tier:t.item.mission0.hardDeadline?"proto":"standard",onClick:i[5]||(i[5]=e=>s.hardDeadlineNo())},{default:l((()=>[z])),_:1},8,["tier"])])]),m("div",W,[J,m("div",X,[k(m("input",{"onUpdate:modelValue":i[6]||(i[6]=e=>t.item.mission0.tags=e),class:"input"},null,512),[[w,t.item.mission0.tags]])])]),m("div",Z,[ee,m("div",ie,[u(N,{query:"v.type == 'Project'",onPick:s.changeProject,tier:s.projectTier},{default:l((()=>[b(v(s.projectTitle),1)])),_:1},8,["onPick","tier"])])]),m("div",te,[se,m("div",ae,[u(Ge,{tier:"proto",class:"q-mr-xs"},{default:l((()=>[oe])),_:1}),u(Ge,{tier:"standard"},{default:l((()=>[ne])),_:1})])]),m("div",re,[ce,m("div",le,[t.item.connections.project?(g(),c(N,{key:0,query:`\n                v.type === 'MemberCard0' \n                && ecs.root['${t.item.connections.project}'].project0members.hasRole(v.id, 'com')\n              `,onPick:s.setCommander,tier:t.item.mission0.commander?"premium":"proto"},{default:l((()=>[b(v(s.commanderTitle),1)])),_:1},8,["query","onPick","tier"])):(g(),d("div",de,"Pick Project First"))])]),m("div",me,[pe,m("div",ue,[(g(!0),d(h,null,x(s.devs,((e,i)=>(g(),d("div",{key:i,class:"developer row no-wrap items-center"},[u(Ge,{tier:e.tier},{default:l((()=>[b(v(e.name),1)])),_:2},1032,["tier"]),u(Ge,{style:{width:"24px",overflow:"hidden",position:"relative"},tier:"monkeys",onClick:i=>s.banish(e)},{default:l((()=>[ve])),_:2},1032,["onClick"])])))),128)),s.devs.length?S("",!0):(g(),d("div",fe,"None")),t.item.connections.project?(g(),c(N,{key:1,query:`\n                v.type === 'MemberCard0' \n                && ecs.root['${t.item.connections.project}'].project0members.hasRole(v.id, 'dev')\n                && !~ecs.root['${t.item.id}'].mission0.assigned.indexOf(v.id)\n              `,onPick:s.assignDev,tier:"standard"},{default:l((()=>[ye])),_:1},8,["query","onPick"])):S("",!0)])]),ge,ke,m("div",we,[be,m("div",xe,[u(Ge,{tier:"proto"},{default:l((()=>[he])),_:1})])]),m("div",Se,[De,m("div",Ne,[u(Ge,{tier:"proto"},{default:l((()=>[je])),_:1})])]),u(Ke,{item:t.item},null,8,["item"])]),Ce,m("footer",Pe,[u(Ge,{tier:"epic",onClick:s.run},{default:l((()=>[Te])),_:1},8,["onClick"]),u(Ge,{tier:"standard",onClick:s.save},{default:l((()=>[_e])),_:1},8,["onClick"]),u(Ge,{tier:"monkeys"},{default:l((()=>[qe])),_:1})])])])),_:1},8,["item"])):"badge"===t.view?(g(),d("div",Oe,[m("div",Be,[m("div",Qe,[p(e.$slots,"n",{},void 0,!0)]),m("div",Fe,[u(We,{item:t.item,x4:"","with-caption":""},null,8,["item"]),u(f,{item:t.item,"only-emit":"",onFav:i[7]||(i[7]=i=>e.$emit("fav",{mission:t.item,fav:i})),style:{display:"inline-block"}},null,8,["item"]),u(Ke,{item:t.item,view:"counter"},null,8,["item"])]),m("div",Le,[m("div",Me,[m("div",Re,v(t.item.mission0.short),1)])]),m("div",Ve,[u(N,{query:"v.type == 'GTDStatus0' && v.located.rel == 'ecKFQsOLw4rDiERkwrTCtB'",nameEP:"i.caption",orderBy:"gtdStatus0.order",tier:s.missionStatusTier,onPick:s.setStatus},{default:l((()=>[b(v(s.missionStatus),1)])),_:1},8,["tier","onPick"])])])])):(g(),d("div",Ae,v(t.item.mission0.short),1))}],["__scopeId","data-v-0e3ba434"]]);export{$e as default};
